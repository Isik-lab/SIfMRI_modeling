perturbation: stripped_orig
model: gpt2
{'process': 'LLMEncoding', 'overwrite': True, 'model_uid': 'gpt2', 'perturbation': 'stripped_orig', 'data_dir': '/home/emcmaho7/scratch4-lisik3/emcmaho7/SIfMRI_modeling/data', 'stimulus_data_file': '/home/emcmaho7/scratch4-lisik3/emcmaho7/SIfMRI_modeling/data/interim/SentenceDecomposition/stripped_orig.csv', 'out_path': '/home/emcmaho7/scratch4-lisik3/emcmaho7/SIfMRI_modeling/data/interim/LLMEncoding/model-gpt2_perturbation-stripped_orig', 'out_file': '/home/emcmaho7/scratch4-lisik3/emcmaho7/SIfMRI_modeling/data/interim/LLMEncoding/model-gpt2_perturbation-stripped_orig.csv'}
loading data...
['a man sits playing video games on his tv while holding a baby with two small dogs resting on a nearby sofa', 'a man with a baby on his lap playing wii', 'a man in shorts sits in a chair next to a standard lamp with a smiling baby on his lap operating a wii remote controller while two small dogs are sat on a nearby sofa', 'a man playing on the wii which is making the baby chuckle while the dog ignores them from the other sofa', 'father & child enjoying a show']
loading model...
tokenized_captions_["input_ids"]=tensor([[   64,   582, 10718,  ..., 50257, 50257, 50257],
        [   64,   582,   351,  ..., 50257, 50257, 50257],
        [   64,   582,   287,  ..., 50257, 50257, 50257],
        ...,
        [   64,   582,  5742,  ..., 50257, 50257, 50257],
        [   64,   582,   318,  ..., 50257, 50257, 50257],
        [   64,   257,  5156,  ..., 50257, 50257, 50257]])
tokenized_captions_["attention_mask"]=tensor([[1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0]])
DeepJuice:INFO (_log) - Extracting sample feature_maps with torchinfo.
Extraction Error Report
(These Layers Skipped)
  Embedding-1-2
   --(add_features) IndexError: No dimension equal to input_size.
FeatureExtractor Handle for GPT2Model
  185 feature maps (+61 duplicates); 1000 inputs
  37 (cuda:0) oversized feature_maps also removed
  Memory required for full extraction: 644.564 GB
  Memory usage limiting device set to: cuda:0
  Memory usage limit currently set to: 10.000 GB
  86 batch(es) required for current memory limit 
   Batch-001: 3 feature maps; 8.790 GB 
   Batch-002: 1 feature maps; 2.930 GB 
   Batch-003: 1 feature maps; 8.789 GB 
   Batch-004: 2 feature maps; 5.860 GB 
   Batch-005: 1 feature maps; 8.789 GB 
   Batch-006: 1 feature maps; 8.789 GB 
   Batch-007: 3 feature maps; 8.790 GB 
   Batch-008: 3 feature maps; 8.790 GB 
   Batch-009: 1 feature maps; 2.930 GB 
   Batch-010: 1 feature maps; 8.789 GB 
   Batch-011: 2 feature maps; 5.860 GB 
   Batch-012: 1 feature maps; 8.789 GB 
   Batch-013: 1 feature maps; 8.789 GB 
   Batch-014: 3 feature maps; 8.790 GB 
   Batch-015: 3 feature maps; 8.790 GB 
   Batch-016: 1 feature maps; 2.930 GB 
   Batch-017: 1 feature maps; 8.789 GB 
   Batch-018: 2 feature maps; 5.860 GB 
   Batch-019: 1 feature maps; 8.789 GB 
   Batch-020: 1 feature maps; 8.789 GB 
   Batch-021: 3 feature maps; 8.790 GB 
   Batch-022: 3 feature maps; 8.790 GB 
   Batch-023: 1 feature maps; 2.930 GB 
   Batch-024: 1 feature maps; 8.789 GB 
   Batch-025: 2 feature maps; 5.860 GB 
   Batch-026: 1 feature maps; 8.789 GB 
   Batch-027: 1 feature maps; 8.789 GB 
   Batch-028: 3 feature maps; 8.790 GB 
   Batch-029: 3 feature maps; 8.790 GB 
   Batch-030: 1 feature maps; 2.930 GB 
   Batch-031: 1 feature maps; 8.789 GB 
   Batch-032: 2 feature maps; 5.860 GB 
   Batch-033: 1 feature maps; 8.789 GB 
   Batch-034: 1 feature maps; 8.789 GB 
   Batch-035: 3 feature maps; 8.790 GB 
   Batch-036: 3 feature maps; 8.790 GB 
   Batch-037: 1 feature maps; 2.930 GB 
   Batch-038: 1 feature maps; 8.789 GB 
   Batch-039: 2 feature maps; 5.860 GB 
   Batch-040: 1 feature maps; 8.789 GB 
   Batch-041: 1 feature maps; 8.789 GB 
   Batch-042: 3 feature maps; 8.790 GB 
   Batch-043: 3 feature maps; 8.790 GB 
   Batch-044: 1 feature maps; 2.930 GB 
   Batch-045: 1 feature maps; 8.789 GB 
   Batch-046: 2 feature maps; 5.860 GB 
   Batch-047: 1 feature maps; 8.789 GB 
   Batch-048: 1 feature maps; 8.789 GB 
   Batch-049: 3 feature maps; 8.790 GB 
   Batch-050: 3 feature maps; 8.790 GB 
   Batch-051: 1 feature maps; 2.930 GB 
   Batch-052: 1 feature maps; 8.789 GB 
   Batch-053: 2 feature maps; 5.860 GB 
   Batch-054: 1 feature maps; 8.789 GB 
   Batch-055: 1 feature maps; 8.789 GB 
   Batch-056: 3 feature maps; 8.790 GB 
   Batch-057: 3 feature maps; 8.790 GB 
   Batch-058: 1 feature maps; 2.930 GB 
   Batch-059: 1 feature maps; 8.789 GB 
   Batch-060: 2 feature maps; 5.860 GB 
   Batch-061: 1 feature maps; 8.789 GB 
   Batch-062: 1 feature maps; 8.789 GB 
   Batch-063: 3 feature maps; 8.790 GB 
   Batch-064: 3 feature maps; 8.790 GB 
   Batch-065: 1 feature maps; 2.930 GB 
   Batch-066: 1 feature maps; 8.789 GB 
   Batch-067: 2 feature maps; 5.860 GB 
   Batch-068: 1 feature maps; 8.789 GB 
   Batch-069: 1 feature maps; 8.789 GB 
   Batch-070: 3 feature maps; 8.790 GB 
   Batch-071: 3 feature maps; 8.790 GB 
   Batch-072: 1 feature maps; 2.930 GB 
   Batch-073: 1 feature maps; 8.789 GB 
   Batch-074: 2 feature maps; 5.860 GB 
   Batch-075: 1 feature maps; 8.789 GB 
   Batch-076: 1 feature maps; 8.789 GB 
   Batch-077: 3 feature maps; 8.790 GB 
   Batch-078: 3 feature maps; 8.790 GB 
   Batch-079: 1 feature maps; 2.930 GB 
   Batch-080: 1 feature maps; 8.789 GB 
   Batch-081: 2 feature maps; 5.860 GB 
   Batch-082: 1 feature maps; 8.789 GB 
   Batch-083: 1 feature maps; 8.789 GB 
   Batch-084: 3 feature maps; 8.790 GB 
   Batch-085: 3 feature maps; 8.790 GB 
   Batch-086: 1 feature maps; 2.930 GB
running regressions
device: cuda
(0) NVIDIA A100-PCIE-40GB: 40.0 GB (87.5% Free)
None
Brain Mapping (Layer):   0%|          | 0/3 [00:00<?, ?it/s]
CV:   0%|          | 0/4 [00:00<?, ?it/s][A
CV:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:00<00:02,  1.33it/s][A
CV:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:00<00:00,  4.20it/s][ACV: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00,  4.31it/s]
Brain Mapping (Layer):  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:01<00:03,  1.91s/it]
CV:   0%|          | 0/4 [00:00<?, ?it/s][A
CV:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:00<00:00, 20.12it/s][ACV: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 19.05it/s]
Brain Mapping (Layer):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:02<00:01,  1.22s/it]
CV:   0%|          | 0/4 [00:00<?, ?it/s][A
CV:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:00<00:00, 19.67it/s][A
CV: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 18.11it/s][ACV: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 18.31it/s]
Brain Mapping (Layer): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.01it/s]                                                                    Brain Mapping (Layer):   0%|          | 0/1 [00:00<?, ?it/s]
CV:   0%|          | 0/4 [00:00<?, ?it/s][A
CV:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:00<00:00, 18.30it/s][A
CV: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 17.28it/s][ACV: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 17.41it/s]
Brain Mapping (Layer): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00,  1.33it/s]                                                                    Traceback (most recent call last):
  File "/scratch4/lisik3/emcmaho7/SIfMRI_modeling/scripts/llm_encoding.py", line 77, in <module>
    main()
  File "/scratch4/lisik3/emcmaho7/SIfMRI_modeling/scripts/llm_encoding.py", line 73, in main
    LLMEncoding(args).run()
  File "/scratch4/lisik3/emcmaho7/SIfMRI_modeling/scripts/llm_encoding.py", line 57, in run
    results = encoding.get_training_benchmarking_results(benchmark, feature_extractor, self.out_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch4/lisik3/emcmaho7/SIfMRI_modeling/src/encoding.py", line 62, in get_training_benchmarking_results
    for feature_maps in feature_extractor:
  File "/scratch4/lisik3/emcmaho7/alphajuice/deepjuice/extraction.py", line 131, in __next__
    return next(self._batch_gen) # multibatch
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch4/lisik3/emcmaho7/alphajuice/deepjuice/extraction.py", line 752, in generate_batches
    yield get_feature_maps(self.model, self.inputs, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch4/lisik3/emcmaho7/alphajuice/deepjuice/extraction.py", line 1081, in get_feature_maps
    feature_maps[uid][idx1:idx2,...] = batch_feature_maps[uid]
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
RuntimeError: The expanded size of the tensor (3) must match the existing size (5) at non-singleton dimension 1.  Target sizes: [1, 3, 12, 1024, 64].  Tensor sizes: [5, 12, 1024, 64]
